using DesignerScripts;
using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Events;

/// <summary>
/// 代表商品格子
/// </summary>
/// <typeparam name="T">商品类型</typeparam>
public abstract class ProductBase<T> : MonoBehaviour where T : class
{
    public bool isEmpty = true;
    public T product;
    // Start is called before the first frame update
    protected virtual void Start()
    {
        OnBuyProduct.AddListener(TryBuy);
        OnBuySuccess.AddListener(ProductBrought);
    }

    /// <summary>
    /// 试图购买，返回是否购买成功
    /// </summary>
    /// <returns></returns>
    protected abstract void TryBuy();

    /// <summary>
    /// 商品初始化
    /// </summary>
    /// <param name="product"></param>
    protected virtual void InitialProduct(T _product)
    {
        isEmpty = false;
        product = _product;
    }

    /// <summary>
    /// 这个商品被买走了
    /// </summary>
    protected virtual void ProductBrought()
    {
        isEmpty = true;
    }

    /// <summary>
    /// 试图购买商品时调用,返回是否购买成功
    /// </summary>
    public UnityEvent OnBuyProduct;
    /// <summary>
    /// 购买成功时调用
    /// </summary>
    public UnityEvent OnBuySuccess;
    /// <summary>
    /// 购买失败是调用
    /// </summary>
    public UnityEvent<BuyFailType> OnBuyFail;

}
/// <summary>
/// 商品购买失败的类型
/// </summary>
public enum BuyFailType
{
    NoMoney,
    NoBagSpace
}